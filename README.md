
# ToggleShortcutArrow

## 简介
本项目包含一个批处理脚本（BAT），用于一键切换 Windows 快捷方式图标上的小箭头显示与隐藏。

- `ToggleShortcutArrow.bat`：批处理脚本（支持自动提权）

## 使用方法

1. 右键脚本，选择“以管理员身份运行”，或直接双击（会自动请求管理员权限）。
2. 脚本会自动检测当前状态并切换快捷方式箭头的显示/隐藏。
3. 操作完成后会询问是否立即重启资源管理器：
	- 输入 Y（不区分大小写）则自动重启资源管理器，立即生效。
	- 输入其他任意键则不重启，稍后可手动重启或注销后生效。

## 原理说明
- 通过修改注册表项 `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Icons` 的 `29` 值，来控制快捷方式箭头的显示与隐藏。
- 恢复箭头时，删除该注册表项，系统恢复默认箭头。
- 隐藏箭头时，将 `29` 的值设置为脚本运行目录下的 `transparent.ico`（一个边长1像素的透明图标），这样快捷方式图标不会显示箭头，也不会出现黑色方框。

## 注意事项
- 需管理员权限。
- 修改注册表有风险，请谨慎操作。
- 更改后需重启资源管理器或注销才能生效。

## 免责声明
本脚本仅供学习和个人使用，使用前请备份重要数据。
